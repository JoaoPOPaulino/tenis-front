<mat-toolbar class="centered-toolbar">
  <div class="toolbar-title">Cadastro de Tênis</div>
</mat-toolbar>

<div class="form-container">
  <mat-card>
    <mat-card-content>
      <form [formGroup]="formGroup">
        <div class="flex-container">
          <mat-form-field appearance="outline">
            <mat-label>Marca</mat-label>
            <mat-select formControlName="marca">
              <mat-option *ngFor="let marca of marcas" [value]="marca">
                {{marca.nome}}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="formGroup.get('marca')?.invalid && formGroup.get('marca')?.touched">
              {{getErrorMessage('marca', formGroup.get('marca')?.errors)}}
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width-input">
            <mat-label>Modelo</mat-label>
            <input matInput type="text" formControlName="modelo" />
            <mat-error *ngIf="formGroup.get('modelo')?.invalid && formGroup.get('modelo')?.touched">
              {{getErrorMessage('modelo', formGroup.get('modelo')?.errors)}}
            </mat-error>
          </mat-form-field>
        </div>

        <mat-form-field appearance="outline" class="full-width-input">
          <mat-label>Descrição</mat-label>
          <input matInput type="text" formControlName="descricao" />
          <mat-error *ngIf="formGroup.get('descricao')?.invalid && formGroup.get('descricao')?.touched">
            {{getErrorMessage('descricao', formGroup.get('descricao')?.errors)}}
          </mat-error>
        </mat-form-field>

        <div class="flex-container">
          <mat-form-field appearance="outline">
            <mat-label>Preço</mat-label>
            <input matInput type="number" formControlName="preco" />
            <mat-error *ngIf="formGroup.get('preco')?.invalid && formGroup.get('preco')?.touched">
              {{getErrorMessage('preco', formGroup.get('preco')?.errors)}}
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Estoque</mat-label>
            <input matInput type="number" formControlName="estoque" />
            <mat-error *ngIf="formGroup.get('estoque')?.invalid && formGroup.get('estoque')?.touched">
              {{getErrorMessage('estoque', formGroup.get('estoque')?.errors)}}
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Tamanho</mat-label>
            <mat-select formControlName="tamanho">
              <mat-option value="PP">PP</mat-option>
              <mat-option value="P">P</mat-option>
              <mat-option value="M">M</mat-option>
              <mat-option value="G">G</mat-option>
              <mat-option value="GG">GG</mat-option>
            </mat-select>
            <mat-error *ngIf="formGroup.get('tamanho')?.invalid && formGroup.get('tamanho')?.touched">
              {{getErrorMessage('tamanho', formGroup.get('tamanho')?.errors)}}
            </mat-error>
          </mat-form-field>
        </div>

        <mat-form-field appearance="outline" class="full-width-input">
          <mat-label>Imagem</mat-label>
          <input type="file" (change)="loadSelectedImage($event)" hidden #fileInput>
          <input matInput [value]="fileName" readonly>
          <button mat-icon-button matSuffix (click)="fileInput.click()">
            <mat-icon>folder_open</mat-icon>
          </button>
        </mat-form-field>

        <div *ngIf="imagePreview" class="image-container">
          <img [src]="imagePreview" alt="Preview">
        </div>
      </form>
    </mat-card-content>

    <mat-card-actions>
      <button mat-raised-button (click)="voltarPagina()">
        Cancelar
      </button>

      <button mat-raised-button *ngIf="formGroup?.get('id')?.value" 
              color="warn" 
              (click)="excluir()"
              [disabled]="formGroup.invalid">
        Excluir
      </button>

      <button mat-raised-button 
              color="primary" 
              (click)="salvar()"
              [disabled]="formGroup.invalid">
        Salvar
      </button>
    </mat-card-actions>
  </mat-card>
</div>